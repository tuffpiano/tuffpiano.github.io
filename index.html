<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Cartoony 3D Piano • Play Me!</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    background: linear-gradient(135deg, #1e0533, #0f0c29, #302b63);
    font-family: Arial, Helvetica, sans-serif;
    overflow: hidden;
    color: #eee;
  }

  h1 {
    text-align: center;
    margin: 15px 0 5px;
    font-size: 2.4rem;
    text-shadow: 0 0 20px #ff6bff, 0 0 40px #a78bfa;
    letter-spacing: 2px;
  }

  .scene {
    perspective: 1200px;
    width: 100%;
    height: 80vh;
    position: relative;
    transform-style: preserve-3d;
  }

  .piano-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotateX(12deg) rotateY(0deg);
    transform-style: preserve-3d;
    width: 860px;
    height: 340px;
  }

  .piano-body {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(#2a1a4a, #140b2e);
    border-radius: 24px;
    box-shadow: 
      0 30px 80px #000000cc,
      inset 0 10px 30px #ffffff0d,
      inset 0 -15px 40px #00000099;
    border: 8px solid #3a2a5a;
  }

  .keys-wrapper {
    position: absolute;
    bottom: 28px;
    left: 20px;
    right: 20px;
    height: 180px;
    display: flex;
    gap: 2px;
    transform: translateZ(18px);
  }

  .key {
    position: relative;
    flex: 1;
    background: white;
    border-radius: 0 0 12px 12px;
    box-shadow: 
      inset 0 -8px 12px #eee,
      0 12px 30px #00000066,
      0 4px 12px #00000044;
    transition: all 0.08s ease;
    cursor: pointer;
    user-select: none;
  }

  .key.black {
    width: 38px;
    height: 110px;
    background: linear-gradient(#222, #111, #000);
    margin: 0 -19px;
    z-index: 2;
    border-radius: 0 0 10px 10px;
    box-shadow: 
      inset 0 -6px 10px #444,
      0 15px 35px #000000aa,
      4px 0 12px #000 inset;
  }

  .key.pressed {
    transform: translateY(12px) translateZ(8px);
    box-shadow: 
      0 4px 12px #ff00cc88,
      inset 0 -4px 10px #ff88ff44;
    background: linear-gradient(to bottom, #ffefff, #ffccff);
  }

  .black.pressed {
    transform: translateY(8px) translateZ(10px);
    background: linear-gradient(#ff44ff, #cc00cc);
    box-shadow: 0 6px 20px #ff00ffaa;
  }

  /* Hands */
  .hands {
    position: absolute;
    bottom: -40px;
    left: 50%;
    transform: translateX(-50%);
    width: 700px;
    height: 220px;
    pointer-events: none;
  }

  .hand {
    position: absolute;
    width: 180px;
    height: 220px;
    background: linear-gradient(135deg, #ffdab9, #ffb07c);
    border-radius: 80px 80px 40px 40px;
    box-shadow: 
      0 20px 50px #00000088,
      inset 0 10px 30px #ffffff55;
    transform-origin: bottom center;
  }

  .hand.left  { left: -60px; transform: rotate(-12deg); }
  .hand.right { right: -60px; transform: rotate(12deg); }

  .fingers {
    position: absolute;
    bottom: 20px;
    left: 20px;
    right: 20px;
    display: flex;
    justify-content: space-between;
  }

  .finger {
    width: 24px;
    height: 80px;
    background: #ffe4d1;
    border-radius: 12px;
    box-shadow: inset 0 -10px 15px #00000033;
    position: relative;
  }

  .finger::after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 4px;
    width: 16px;
    height: 16px;
    background: #ff9999;
    border-radius: 50%;
    box-shadow: 0 4px 10px #ff4444aa;
  }

  .hand.left  .finger { transform: rotate(8deg); }
  .hand.right .finger { transform: rotate(-8deg); }

  .label {
    position: absolute;
    top: -28px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 1.1rem;
    color: #ffccff;
    text-shadow: 0 0 12px #ff88ff;
    pointer-events: none;
    opacity: 0.9;
  }

  .octave-label {
    position: absolute;
    top: -45px;
    font-size: 1.3rem;
    color: #cc99ff;
    text-shadow: 0 0 15px #9966ff;
  }
</style>
</head>
<body>

<h1>✨ C a r t o o n  3 D  P i a n o ✨</h1>

<div class="scene">
  <div class="piano-container">
    <div class="piano-body"></div>

    <div class="keys-wrapper" id="keys"></div>

    <div class="hands">
      <div class="hand left"  id="handLeft"></div>
      <div class="hand right" id="handRight"></div>
    </div>
  </div>
</div>

<script>
// ────────────────────────────────────────────────
const NOTES = [
  {note:"C4",  key:"z", isBlack:false, offset:0},
  {note:"C#4", key:"s", isBlack:true,  offset:1},
  {note:"D4",  key:"x", isBlack:false, offset:2},
  {note:"D#4", key:"d", isBlack:true,  offset:3},
  {note:"E4",  key:"c", isBlack:false, offset:4},
  {note:"F4",  key:"v", isBlack:false, offset:5},
  {note:"F#4", key:"g", isBlack:true,  offset:6},
  {note:"G4",  key:"b", isBlack:false, offset:7},
  {note:"G#4", key:"h", isBlack:true,  offset:8},
  {note:"A4",  key:"n", isBlack:false, offset:9},
  {note:"A#4", key:"j", isBlack:true,  offset:10},
  {note:"B4",  key:"m", isBlack:false, offset:11},

  {note:"C5",  key:"q", isBlack:false, offset:12},
  {note:"C#5", key:"2", isBlack:true,  offset:13},
  {note:"D5",  key:"w", isBlack:false, offset:14},
  {note:"D#5", key:"3", isBlack:true,  offset:15},
  {note:"E5",  key:"e", isBlack:false, offset:16},
  {note:"F5",  key:"r", isBlack:false, offset:17},
  {note:"F#5", key:"5", isBlack:true,  offset:18},
  {note:"G5",  key:"t", isBlack:false, offset:19},
  {note:"G#5", key:"6", isBlack:true,  offset:20},
  {note:"A5",  key:"y", isBlack:false, offset:21},
  {note:"A#5", key:"7", isBlack:true,  offset:22},
  {note:"B5",  key:"u", isBlack:false, offset:23},
];

const keyMap = {};
NOTES.forEach(n => keyMap[n.key] = n);

const piano = document.getElementById("keys");
const handL = document.getElementById("handLeft");
const handR = document.getElementById("handRight");

let activeKeys = new Set();

// Create visual keys
NOTES.forEach((item, i) => {
  const k = document.createElement("div");
  k.className = "key" + (item.isBlack ? " black" : "");
  k.dataset.note = item.note;
  k.dataset.index = i;

  if (!item.isBlack) {
    const lbl = document.createElement("div");
    lbl.className = "label";
    lbl.textContent = item.note;
    k.appendChild(lbl);

    if (item.note === "C4" || item.note === "C5") {
      const oct = document.createElement("div");
      oct.className = "octave-label";
      oct.textContent = item.note[0] + (item.note[1]==="4"?"":"⁵");
      k.appendChild(oct);
    }
  }

  piano.appendChild(k);
});

// Simple finger follow (very cartoon style)
function moveHand(hand, targetX) {
  const current = parseFloat(hand.style.left || "0");
  const diff = targetX - current;
  hand.style.transition = "left 0.18s ease-out, transform 0.14s";
  hand.style.left = (current + diff * 0.6) + "px";

  // slight bounce / squash
  hand.style.transform = `rotate(${12 + diff*0.08}deg) scale(1.04, 0.96)`;
  setTimeout(() => {
    hand.style.transform = `rotate(${12 + diff*0.04}deg) scale(1,1)`;
  }, 140);
}

window.addEventListener("keydown", e => {
  if (e.repeat) return;
  const k = e.key.toLowerCase();
  if (!keyMap[k]) return;

  const noteInfo = keyMap[k];
  const keyEl = document.querySelector(`.key[data-note="${noteInfo.note}"]`);
  if (!keyEl) return;

  keyEl.classList.add("pressed");

  // Very naive hand positioning (just for fun)
  const keyRect = keyEl.getBoundingClientRect();
  const pianoRect = piano.getBoundingClientRect();
  const relX = keyRect.left - pianoRect.left + keyRect.width/2;

  if (["z","s","x","d","c","v","g","b","h","n","j","m"].includes(k)) {
    moveHand(handL, relX - 340);
  } else {
    moveHand(handR, relX - 340);
  }

  activeKeys.add(k);

  // You could add real sound here with Web Audio API
  // const osc = audioCtx.createOscillator();
  // osc.frequency.value = noteFreq[noteInfo.note];
  // osc.connect(audioCtx.destination);
  // osc.start(); setTimeout(()=>osc.stop(), 800);
});

window.addEventListener("keyup", e => {
  const k = e.key.toLowerCase();
  if (!keyMap[k]) return;

  const noteInfo = keyMap[k];
  const keyEl = document.querySelector(`.key[data-note="${noteInfo.note}"]`);
  keyEl?.classList.remove("pressed");

  activeKeys.delete(k);
});

// Touch support (very basic)
piano.addEventListener("pointerdown", e => {
  const key = e.target.closest(".key");
  if (!key) return;

  const note = key.dataset.note;
  const info = NOTES.find(n => n.note === note);
  if (!info) return;

  key.classList.add("pressed");

  const relX = e.clientX - piano.getBoundingClientRect().left;
  if (relX < 430) {
    moveHand(handL, relX - 20);
  } else {
    moveHand(handR, relX - 20);
  }
});

piano.addEventListener("pointerup", e => {
  const key = e.target.closest(".key");
  key?.classList.remove("pressed");
});
</script>

</body>
</html>
